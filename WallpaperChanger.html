<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Wallpaper Changer</title>

    <style type="text/css">
    body {
        font-family: "Open Sans", sans-serif;
    }
    a {
        padding: 20px;
        text-decoration: none;
        color: white;
        border: solid 1px #c0392b;
        background-color: #e74c3c;
    }
    </style>
</head>

<body>

    <h1>Wallpaper Changer</h1>
    <p>Press the "Set Wallpaper" button, then click where the arrow points to change your desktop wallpaper.</p>
    <br>
    <a href="SERVER_DIRECTORY\WallpaperChanger.jar" download="WallpaperChanger.jar" onclick="Arrow.show()">Set Wallpaper</a>

    <script>

    window.Arrow=function(window,document){
		"use strict";
		function _increaseOpacity(seconds){
			var arrow=document.getElementById("arrow-"+browser);arrow.style.display="block";
			var i=0,
			ieI=0,
			x=setInterval(function(){
				i+=.1,ieI+=10,"msie"===browser&&8>=browserVersion?arrow.filters&&(arrow.filters.item("DXImageTransform.Microsoft.Alpha").opacity=ieI):arrow.style.opacity=i},50);
				setTimeout(function(){
					clearInterval(x)},600),setTimeout(function(){
						_hide()},seconds||6e3)}
						function _decreaseOpacity(){
							var arrow=document.getElementById("arrow-"+browser),i=1,ieI=100,x=setInterval(
								function(){
									i-=.1,
									ieI-=10,
									"msie"===browser&&8>=browserVersion?arrow.filters&&(arrow.filters.item("DXImageTransform.Microsoft.Alpha").opacity=ieI):arrow.style.opacity=i},50);setTimeout(
										function(){
											clearInterval(x),arrow.style.display="none"},600)}
	function _applyStyleModern(node){
		node.style.position="fixed",node.style.zIndex=999,node.style.display="none",node.style.height="309px",node.style.width="186px",node.style.opacity=0,node.style.backgroundImage="url(http://i.imgur.com/aMwoyfN.png)",node.style.backgroundRepeat="no-repeat",node.style.backgroundPositionX="0",node.style.backgroundPositionY="0"
		}
		function _applyStyleIE8(node){node.style.top="10px",node.style.left="20px";var opacity="progid:DXImageTransform.Microsoft.Alpha(opacity=0) ",imgSrc='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="http://i.imgur.com/aMwoyfN.png", sizingMethod="scale") ',rotation='progid:DXImageTransform.Microsoft.Matrix(M11=1, M12=1.2246063538223773e-16, M21=-1.2246063538223773e-16, M22=-1, SizingMethod="auto expand") ';node.style.filter=opacity+imgSrc+rotation}
		function _applyStyleMs(node){node.style.bottom="50px",node.style.left="67%"}
		function _applyStyleIE11(node){node.style.bottom="50px",node.style.left="67%"}
		function _applyStyleedge(node){node.style.bottom="50px",node.style.left="67%"}
		function _applyStyleMoz(node){node.style.top="0px",node.style.right="37px",node.style.transform="rotateX(180deg) rotateY(180deg)",node.style.MozTransform="rotateX(180deg) rotateY(180deg)"}
		function _applyStyleWebkit(node){node.style.bottom="50px",node.style.left="20px"}
		function _applyStyleMac(node){node.style.top="0px",node.style.right="37px",node.style.transform="rotateX(180deg) rotateY(180deg)",node.style.webkitTransform="rotateX(180deg) rotateY(180deg)"}
		function _setStyleType(node){
			_applyStyleModern(node),
			"msie"===browser?8===browserVersion?_applyStyleIE8(node):
			(9===browserVersion||10===browserVersion)&&_applyStyleMs(node):
			"opera"===browser?_applyStyleWebkit(node):
			"chrome"===browser?_applyStyleWebkit(node):
			"firefox"===browser?_applyStyleMoz(node):
			"safari"===browser?_applyStyleMac(node):
			"IE11"===browser?_applyStyleIE11(node):
			"edge"===browser&&_applyStyleedge(node)
		}
		function _buildArrow(){var div=document.createElement("div");return div.setAttribute("id","arrow-"+browser),arrowNode=div,div}
		function _injectNode(node){document.body.appendChild(node)}
		function _isExist(){return!!document.getElementById("arrow-"+browser)}
		function _initArrow(){
			var arrow=_buildArrow();_setStyleType(arrow),_calculateArrowPosition(),_injectNode(arrow),_addWindowEvent("resize",_calculateArrowPosition),_addWindowEvent("scroll",_calculateArrowPosition)}
			function _addWindowEvent(event,functionReference){
				window.addEventListener?window.addEventListener(event,functionReference,!1):window.attachEvent&&window.attachEvent(event,functionReference)
			}function _calculateArrowPosition(){
				"number"==typeof window.innerWidth?(visibleWidth=window.innerWidth,visibleHeight=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)&&(visibleWidth=document.documentElement.clientWidth,visibleHeight=document.documentElement.clientHeight),"msie"===browser&&9===browserVersion&&(1005>visibleWidth?arrowNode.style.bottom="85px":visibleWidth>1006&&(arrowNode.style.bottom="50px"))
			}function _hide(){
				if(!_isExist())throw"Invalid usage: There are no arrows on the page.";_decreaseOpacity()}
				function show(seconds){
					if(!_isExist())throw"Invalid usage: arrow does not exist";_increaseOpacity(seconds)}
					var arrowNode,version="0.1.6",Arrow={},browser="",browserVersion=0,visibleHeight=0,visibleWidth=0;
					return function(){
						var tem,N=navigator.appName,ua=navigator.userAgent,M=ua.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);M&&null!=(tem=ua.match(/version\/([\.\d]+)/i))&&(M[2]=tem[1]),M=M?[M[1],M[2]]:[N,navigator.appVersion,"-?"],browser=(M[0].toLowerCase()=="netscape")?"IE11":(ua.toLowerCase().indexOf('edge')!=-1)?"edge":M[0].toLowerCase(),browserVersion=parseInt(M[1],10)}(),_initArrow(),Arrow._version=version,Arrow._browser=browser,Arrow._browserVersion=browserVersion,Arrow.show=show,Arrow}(window,window.document);
    </script>

</body>
</html>
